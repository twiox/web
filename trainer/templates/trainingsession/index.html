{% extends 'members/base.html' %}
{% block navbar2 %} 
<div class="navbar primary_bg padding_all_small" style="margin-top:2px;">
    <a class="more_info_button float_left" style="font-size: 1.1rem;" href="{% url 'trainer_index' %}#nav">
        Trainerdokument </a>
    <a class="float_left"> > </a>
    <a class="float_left strong" style="font-size: 1.1rem; color:white;">Session</a>
</div>
{% endblock %}
{% block content %}
<h1>Neue Trainingsstunde</h1>
<form method="POST">
    {% csrf_token %}
    <div>
        <label class="mdc-text-field mdc-text-field--filled date">
            <span class="mdc-text-field__ripple"></span>
            <input type="date" class="mdc-text-field__input" aria-labelledby="date-label" name="date" value="{{today}}">
            <span class="mdc-floating-label" id="date-label">Datum</span>
            <span class="mdc-line-ripple"></span>
        </label>
    </div>
    <div>
        <label class="mdc-text-field mdc-text-field--filled session">
            <i class="mdc-select__dropdown-icon"></i>
            <span class="mdc-text-field__ripple"></span>
            <select id="select-session" class="mdc-text-field__input" name="session">
                <option value="">---------</option>
                {% for choice in form.session.field.queryset %}
                    <option value="{{ choice.pk }}" {% if choice.pk == form.session.value %} selected {% endif %}>
                        {{ choice }}
                    </option>
                {% endfor %}
            </select>
            <span class="mdc-floating-label" id="session-label">Trainingseinheit</span>
            <span class="mdc-line-ripple"></span>
        </label>
    </div>
    <div>
        {% if form.group.errors %}
        {% for error in form.group.errors %}
            <p style="color:red;">{{error}}</p>
        {% endfor %}
        {% endif %}
        <label class="mdc-text-field mdc-text-field--filled group">
            <span class="mdc-text-field__ripple"></span>
            <input id="group" type="text" class="mdc-text-field__input" aria-labelledby="group-label" name="group">
            <span class="mdc-floating-label" id="group-label">Gruppe</span>
            <span class="mdc-line-ripple"></span>
        </label>
    </div>

    <div>
        {% if form.start.errors %}
        {% for error in form.start.errors %}
            <p style="color:red;">{{error}}</p>
        {% endfor %}
        {% endif %}
        <label class="mdc-text-field mdc-text-field--filled start">
            <span class="mdc-text-field__ripple"></span>
            <input id="start_time" type="time" class="mdc-text-field__input" aria-labelledby="start-label" name="start" value="17:00">
            <span class="mdc-floating-label" id="start-label">Start</span>
            <span class="mdc-line-ripple"></span>
        </label>
    </div>

    <div>
        {% if form.end.errors %}
        {% for error in form.end.errors %}
            <p style="color:red;">{{error}}</p>
        {% endfor %}
        {% endif %}
        <label class="mdc-text-field mdc-text-field--filled end">
            <span class="mdc-text-field__ripple"></span>
            <input id="end_time" type="time" class="mdc-text-field__input" aria-labelledby="end-label" name="end" value="19:00">
            <span class="mdc-floating-label" id="end-label">Ende</span>
            <span class="mdc-line-ripple"></span>
        </label>
    </div>
    
    <div style="clear:both;">
        <div class="flex_center_vertical">
            <div class="flex_center padding_all_big">
                <button type="submit" class="form_button" id="prob_button">Absenden</button>
            </div>
        </div>
    </div>
</form>


<script>
$(document).ready(function () {

    $('body').on("change", '#select-session', function () {
        const sessionId = $(this).val();
        console.log(sessionId)

        $.ajax({
            url: "{% url 'fill_session_details' %}",
            data: {
                session_id: sessionId
            },
            dataType: "json",
            success: function (data) {
                console.log(data)
                $("#start_time").val(data.start_time);
                $("#end_time").val(data.end_time);
                $("#group").val(`${data.age_lower}-${data.age_upper} Jahre`);
            },
        });
    });

});
</script>


{% endblock %}

